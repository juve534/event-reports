# PHPカンファレンス仙台参加レポート
## [PHPではじめるCQRS](https://speakerdeck.com/dnskimo/phpdehazimerucqrs)
### TL;DR
* `CQRS`の前に`CQS`を知る
  * `コマンド(命令)`と`クエリ(問い合わせ)`を分けるクラス設計
  * 読み書きを同じメソッドでやらないことで、信頼性や再利用性を向上させる
* `CQRS`はアーキテクチャ設計
  * アーキテクチャも`コマンド(命令)`と`クエリ(問い合わせ)`で分離する
  * `クエリ`は`Elasticsearch`といった`NoSQL`が使われることが多いが、`RDB`でも行ける
    * ORMを使わず、クエリを組み立てることで、`SQL`の真価を発揮させる

### なぜこのセッションを聞いたのか
最近CQRSという言葉をよく聞くようになりました。  
CQRSがどういうものか興味を持っておりましたが、一方でCQRSとセットで、イベントソーシング（RabbitMQやApache Kafkaなどを利用）が語られており、実装する上でハードルが高いなと感じておりました。  

今回の発表者はPHPで実装するということで、どういった設計と実装を行っているか気になり、聴きに行きました。

### 内容
PHPでイベントソーシングをやる話だと思っていましたが、SQLを駆使するという話でした。  
若干の肩透かし感はありましたが、内容は納得ができるものでした。  

LaravelやCakePHPといったFWを使った事がある人なら、ORMの便利さとデータ量が増えた際の厳しさもわかるかなと思います。  
今回のセッションであったように、検索をフルに行いたい場合は、SQLを自分で組んでやるのが良いですね。

またValue Objectなるもので、コマンドとクエリでロジックの共有を行うのも良い工夫ですね。

ちなみに、SQLを生SQLではなくクエリビルダで組んだのは、SQLインジェクション対策らしいです。

### まとめ
難しい単語は出ていますが、丁寧に解説されているので、`CQRS`を知りたい人に良い内容だと思います。  
自分は、近々でデータ集計を行うタスクがあったので、その際はORMではなく、SQLを組み立ててやろうと思います。